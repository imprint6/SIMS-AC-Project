<div *ngIf="isLoading">Loading ticket details...</div>
<div *ngIf="isError">{{ errorMessage }}</div>

<form *ngIf="!isLoading && !isError" [formGroup]="ticketForm" (ngSubmit)="onSubmit()">
  <mat-form-field appearance="fill">
    <mat-label>Title</mat-label>
    <input matInput formControlName="title" />
    <mat-error *ngIf="ticketForm.get('title')?.invalid && ticketForm.get('title')?.touched">
      Title is required.
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Description</mat-label>
    <textarea matInput formControlName="description"></textarea>
    <mat-error *ngIf="ticketForm.get('description')?.invalid && ticketForm.get('description')?.touched">
      Description is required.
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>State</mat-label>
    <mat-select formControlName="state">
      <mat-option *ngFor="let state of stateEnum" [value]="state.value">{{ state.label }}</mat-option>
    </mat-select>
    <mat-error *ngIf="ticketForm.get('state')?.invalid && ticketForm.get('state')?.touched">
      State is required.
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Severity</mat-label>
    <input matInput type="number" formControlName="severity" />
    <mat-error *ngIf="ticketForm.get('severity')?.invalid && ticketForm.get('severity')?.touched">
      Severity must be between 1 and 10.
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>CVE</mat-label>
    <input matInput formControlName="cve" />
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>Assigned Person ID</mat-label>
    <input matInput formControlName="assignedPersonID" />
  </mat-form-field>

  <button mat-raised-button color="primary" type="submit" [disabled]="ticketForm.invalid">Update Ticket</button>
</form>
